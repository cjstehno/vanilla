<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<meta name="author" content="Christopher J. Stehno">
<title>Vanilla Users Guide</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:initial}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px 0}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:.4em .75em 0 .75em;line-height:1;vertical-align:top}
.colist>table tr>td:first-of-type img{max-width:initial}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Vanilla Users Guide</h1>
<div class="details">
<span id="author" class="author">Christopher J. Stehno</span><br>
<span id="email" class="email"><a href="mailto:chris@stehno.com">chris@stehno.com</a></span><br>
<span id="revnumber">version 0.6.0,</span>
<span id="revdate">December 2017</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">Introduction</a></li>
<li><a href="#_lazy_immutable">Lazy Immutable</a></li>
<li><a href="#_property_randomizers">Property Randomizers</a>
<ul class="sectlevel2">
<li><a href="#_operations">Operations</a></li>
<li><a href="#_randomizer_builder">Randomizer Builder</a></li>
<li><a href="#_randomizer_dsl">Randomizer DSL</a></li>
<li><a href="#_provided_randomizers">Provided Randomizers</a></li>
<li><a href="#_randomizing_simple_types">Randomizing Simple Types</a></li>
</ul>
</li>
<li><a href="#_object_mappers">Object Mappers</a>
<ul class="sectlevel2">
<li><a href="#_object_mapper_dsl">Object Mapper DSL</a></li>
<li><a href="#_runtime_mappers">Runtime Mappers</a></li>
<li><a href="#_compiled_mappers">Compiled Mappers</a></li>
<li><a href="#_usage">Usage</a></li>
</ul>
</li>
<li><a href="#_resultset_mappers">ResultSet Mappers</a>
<ul class="sectlevel2">
<li><a href="#_mapping_style">Mapping Style</a></li>
<li><a href="#_dsl">DSL</a></li>
<li><a href="#_runtime_implementation">Runtime Implementation</a></li>
<li><a href="#_compiled_implementation">Compiled Implementation</a></li>
<li><a href="#_usage_2">Usage</a></li>
<li><a href="#_field_name_prefix">Field Name Prefix</a></li>
<li><a href="#_mapping_properties_from_multiple_fields">Mapping Properties from Multiple Fields</a></li>
</ul>
</li>
<li><a href="#_mockresultset_dsl">MockResultSet DSL</a>
<ul class="sectlevel2">
<li><a href="#_resultset_dsl">ResultSet DSL</a></li>
</ul>
</li>
<li><a href="#_overlappable">Overlappable</a></li>
<li><a href="#_test_fixtures">Test Fixtures</a>
<ul class="sectlevel2">
<li><a href="#_fixture_dsl">Fixture DSL</a></li>
<li><a href="#_usage_3">Usage</a></li>
</ul>
</li>
<li><a href="#_rolling_file">Rolling File</a></li>
<li><a href="#_layered_configuration">Layered Configuration</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Vanilla library is a multi-purpose utility library containing a lot of "what if" and experimentation code that actually seemed to have a
potential use, so it was made publicly available.</p>
</div>
<div class="paragraph">
<p>The project web site is: <a href="http://stehno.com/vanilla" class="bare">http://stehno.com/vanilla</a></p>
</div>
<div class="paragraph">
<p>The source code for the project is hosted on GitHub at: <a href="https://github.com/cjstehno/vanilla" class="bare">https://github.com/cjstehno/vanilla</a></p>
</div>
<div class="paragraph">
<p>Vanilla is licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2</a> open source license.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lazy_immutable">Lazy Immutable</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Groovy <code>@Immutable</code> annotation is quite useful; however, it is an all-or-nothing object, meaning that you create it once and then you can&#8217;t touch
it again (other than copying it with different properties). The <code>@LazyImmutable</code> annotation in Vanilla allows for a slighly more flexible configuration
of immutable objects.</p>
</div>
<div class="paragraph">
<p>Consider the case of of an immutable Person object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="annotation">@Immutable</span>
<span class="type">class</span> <span class="class">Person</span> {
    <span class="predefined-type">String</span> firstName
    <span class="predefined-type">String</span> middleName
    <span class="predefined-type">String</span> lastName
    <span class="type">int</span> age
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>With <code>@Immutable</code> you have to create the object all at once:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> person = <span class="keyword">new</span> Person(<span class="string"><span class="delimiter">'</span><span class="content">Chris</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">J</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">Stehno</span><span class="delimiter">'</span></span>,<span class="integer">42</span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>and then you&#8217;re stuck with it. You can create a copy of it with one or more different properties using the <code>copyWith</code> method, but you need to specify
the <code>copyWith=true</code> in the annotation itself, then you can do something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">Person otherPerson = person.copyWith(<span class="key">firstName</span>:<span class="string"><span class="delimiter">'</span><span class="content">Bob</span><span class="delimiter">'</span></span>, <span class="key">age</span>:<span class="integer">50</span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>With more complicated immutables, this "all at once" requirement can be annoying. This is where the <code>@LazyImmutable</code> annotation becomes useful. With
a similar Person class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="annotation">@LazyImmutable</span> <span class="annotation">@Canonical</span>
<span class="type">class</span> <span class="class">Person</span> {
    <span class="predefined-type">String</span> firstName
    <span class="predefined-type">String</span> middleName
    <span class="predefined-type">String</span> lastName
    <span class="type">int</span> age
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>using the new annotation, you can create and populate the instance over time:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> person = <span class="keyword">new</span> Person(<span class="string"><span class="delimiter">'</span><span class="content">Chris</span><span class="delimiter">'</span></span>)
person.middleName = <span class="string"><span class="delimiter">'</span><span class="content">J</span><span class="delimiter">'</span></span>
person.lastName = <span class="string"><span class="delimiter">'</span><span class="content">Stehno</span><span class="delimiter">'</span></span>
person.age = <span class="integer">42</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice that the <code>@LazyImmutable</code> annotation does not apply any other transforms (as the standard <code>@Immutable</code> does). It&#8217;s a standard Groovy object,
but with an added method: the <code>asImmutable()</code> method is injected via AST Transformation. This method will take the current state of the object and
create an immutable version of the object - this does imply that the properties of lazy immutable objects should follow the same rules as those of
the standard immutable so that the conversion is determinate. For our example case:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">Person immutablePerson = person.asImmutable()</code></pre>
</div>
</div>
<div class="paragraph">
<p>The created object is the same immutable object as would have been created by using the <code>@Immutable</code> annotation and it is generated as an extension
of the class you created so that it&#8217;s type is still valid. The immutable version of the object also has a useful added method, the <code>asMutable()</code>
method is used to create a copy of the original mutable object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">Person otherMutable = immutablePerson.asMutable()</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can swap back and forth between immutability and mutability as needed without loss of functionality or data integrity.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_property_randomizers">Property Randomizers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Generating large amounts of meaningful test data can be tedious and sometimes error prone if your test values arbitrarily fit your code and don&#8217;t
properly exercise it. Randomly generating test data objects can be a simple way to test different scenarios across the same tests and also simplify
your test writing.</p>
</div>
<div class="paragraph">
<p>The <code>PropertyRandomizer</code> can be used as a builder by using the classes directly or as a DSL.</p>
</div>
<div class="sect2">
<h3 id="_operations">Operations</h3>
<div class="paragraph">
<p>The <code>PropertyRandomizer</code> instances have six configuration methods and three builder methods. The configuration methods are:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>ignoringTypes(Class&#8230;&#8203;)</code></dt>
<dd>
<p>Specifies the given property types should be ignored and not randomized.</p>
</dd>
<dt class="hdlist1"><code>ignoringProperties(String&#8230;&#8203;)</code></dt>
<dd>
<p>Specifies that the given property names should be ignored and not randomized.</p>
</dd>
<dt class="hdlist1"><code>typeRandomizers(Map&lt;Class,Object&gt;)</code></dt>
<dd>
<p>Allows the specification of multiple type randomizers, where the map is property type to the appropriate randomizer.</p>
</dd>
<dt class="hdlist1"><code>typeRandomizer(Class, Object)</code></dt>
<dd>
<p>Specifies a single randomizer for a property type.</p>
</dd>
<dt class="hdlist1"><code>propertyRandomizers(Map&lt;String,Object&gt;)</code></dt>
<dd>
<p>Allows the specification of multiple property randomizers, where the map is property name to the appropriate randomizer.</p>
</dd>
<dt class="hdlist1"><code>propertyRandomizer(String, Object)</code></dt>
<dd>
<p>Specifies a single randomizer for a property name.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The <code>Object</code> configured as a "randomizer" may be either a <code>PropertyRandomizer</code> instance or a <code>Closure</code>. If a <code>Closure</code> is used, it will allow up to
two arguments to the <code>Closure</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If no arguments are specified, the returned value must be built using external code</p>
</li>
<li>
<p>If one argument is specified, it will be the <code>Random</code> instance used by the randomizer for generating random data.</p>
</li>
<li>
<p>If two arguments are passed in, the first will be the <code>Random</code> as above, and the second will be the map of properties which will be used to populate the target object.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The allowed builder methods are:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>one()</code></dt>
<dd>
<p>Instantiates a single randomized instance of the target object.</p>
</dd>
<dt class="hdlist1"><code>times(int)</code></dt>
<dd>
<p>Instantiates a collection of multiple randomized instances of size equal to the provided count.</p>
</dd>
<dt class="hdlist1"><code>*(int)</code></dt>
<dd>
<p>An alias to the <code>times(int)</code> method for operator-overridden shorthand notation.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_randomizer_builder">Randomizer Builder</h3>
<div class="paragraph">
<p>The <code>PropertyRandomizer</code> class allows randomizers to be built directly from the mutator methods of the class. Pulling an example from the unit tests
we can see how the builder uses the configuration and builder operations:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">PropertyRandomizer rando = PropertyRandomizer.randomize(Person)
    .ignoringProperties(<span class="string"><span class="delimiter">'</span><span class="content">bankPin</span><span class="delimiter">'</span></span>)
    .typeRandomizers(
        (<span class="predefined-type">Date</span>)    : { <span class="keyword">new</span> <span class="predefined-type">Date</span>() },
        (Pet)     : { randomize(Pet).one() },
        (<span class="predefined-type">String</span><span class="type">[]</span>): forStringArray()
    )
    .propertyRandomizers(<span class="key">name</span>: { <span class="string"><span class="delimiter">'</span><span class="content">FixedValue</span><span class="delimiter">'</span></span> })</code></pre>
</div>
</div>
<div class="paragraph">
<p>The code above creates a <code>PropertyRandomizer</code> for the <code>Person</code> class where the <code>bankPin</code> property is ignored, the <code>name</code> property is "randomized" to a
fixed value "FixedValue", and the properties of type <code>Date</code>, <code>Pet</code>, and <code>String[]</code> are randomized using the provided custom randomizers. To generate
random instances using this randomizer you could do any of the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">Person personA = rando.one()
<span class="predefined-type">Collection</span>&lt;Person&gt; fourPeople = rando.times(<span class="integer">4</span>)
<span class="predefined-type">Collection</span>&lt;Person&gt; tenPeople = rando * <span class="integer">10</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_randomizer_dsl">Randomizer DSL</h3>
<div class="paragraph">
<p>Using the DSL version of the randomizer is not really any different than using the builder style. For the example specified above, we would have the
following code to achieve the same randomizer:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">PropertyRandomizer rando = PropertyRandomizer.randomize(Person){
    ignoringProperties <span class="string"><span class="delimiter">'</span><span class="content">bankPin</span><span class="delimiter">'</span></span>
    typeRandomizers(
        (<span class="predefined-type">Date</span>)    : { <span class="keyword">new</span> <span class="predefined-type">Date</span>() },
        (Pet)     : { randomize(Pet).one() },
        (<span class="predefined-type">String</span><span class="type">[]</span>): forStringArray()
    )
    propertyRandomizers <span class="key">name</span>: { <span class="string"><span class="delimiter">'</span><span class="content">FixedValue</span><span class="delimiter">'</span></span> }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The main difference being that the operations are specified within a <code>Closure</code>, which could be shared or configured externally to the rest of the code.</p>
</div>
</div>
<div class="sect2">
<h3 id="_provided_randomizers">Provided Randomizers</h3>
<div class="paragraph">
<p>The library provides a collection of useful randomizers, some of which are configured by default in the <code>PropertyRandomizer</code>, in the <code>Randomizers</code>
utility class. These may be used directly or as randomizer objects for the <code>PropertyRandomizer</code> configurations.</p>
</div>
</div>
<div class="sect2">
<h3 id="_randomizing_simple_types">Randomizing Simple Types</h3>
<div class="paragraph">
<p>The <code>PropertyRandomizer</code> is not just useful for complex objects, it will also provide random instances of more simple types, such as <code>String</code> and
<code>Date</code> objects.</p>
</div>
<div class="paragraph">
<p>If the type to be randomized is one of the built-in class randomizers (<code>String</code> and the primitive types and their wrapper classes) you can randomize
them directly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">PropertyRandomizer stringRando = PropertyRandomizer.randomize(<span class="predefined-type">String</span>)
PropertyRandomizer dateRando = PropertyRandomizer.randomize(<span class="predefined-type">Date</span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Other, non-default types may also be configured in a similar manner, by adding a <code>typeRandomizer(Class,Object)</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">Class</span> byteArray = (<span class="type">[]</span> <span class="keyword">as</span> <span class="type">byte</span><span class="type">[]</span>).class
PropertyRandomizer stringRando = PropertyRandomizer.randomize(byteArray){
    typeRandomizer byteArray, Randomizers.forByteArray()
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This code will create random instances of <code>byte</code> arrays. The extra code for determining the <code>Class</code> for the <code>byte</code> array is a work-around for an odd
issue with Groovy typing and byte arrays - not really related to the example at hand.</p>
</div>
<div class="paragraph">
<p>Generally, this approach should be left to very simple value-type objects. In many cases, you could also just use the randomizers provided in the
<code>Randomizers</code> class directly.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_object_mappers">Object Mappers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When working with legacy or external code-bases you may run into an API where you end up doing a lot of domain object mapping, from one object format
to another. The Vanilla Object Mappers framework can help simplify the mappings. It comes in two forms, a dynamic runtime implementation and a
compile-time generated implementation.</p>
</div>
<div class="paragraph">
<p>Generated <code>ObjectMapper</code> instances are stateless and thread-safe.</p>
</div>
<div class="sect2">
<h3 id="_object_mapper_dsl">Object Mapper DSL</h3>
<div class="paragraph">
<p>The DSL used by the <code>ObjectMapper</code> framework is shared between both the runtime and compiled implementations. There are four supported mapping
statements:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>map &lt;source-name&gt;</code></dt>
<dd>
<p>Maps the specified source property into the destination property of the same name, with no conversion.</p>
</dd>
<dt class="hdlist1"><code>map &lt;source-name&gt; into &lt;destination-name&gt;</code></dt>
<dd>
<p>Maps the specified source property into the specified destination property, with no conversion.</p>
</dd>
<dt class="hdlist1"><code>map &lt;source-name&gt; into &lt;destination-name&gt; using &lt;closure&gt;</code></dt>
<dd>
<p>Maps the specified source property into the specified destination property, with the given conversion closure.</p>
</dd>
<dt class="hdlist1"><code>map &lt;source-name&gt; using &lt;closure&gt;</code></dt>
<dd>
<p>Maps the specified source property int the destination property of the same name, with the given conversion closure.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The conversion closures configured by the <code>using</code> clause are standard Groovy closures that are allowed to accept up to three arguments:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Argument one - source property value</p>
</li>
<li>
<p>Argument two - source object reference</p>
</li>
<li>
<p>Argument three - destination object reference</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A sample of the DSL pulled from the unit tests is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">map <span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span>
map <span class="string"><span class="delimiter">'</span><span class="content">age</span><span class="delimiter">'</span></span> into <span class="string"><span class="delimiter">'</span><span class="content">years</span><span class="delimiter">'</span></span>
map <span class="string"><span class="delimiter">'</span><span class="content">startDate</span><span class="delimiter">'</span></span> using { <span class="predefined-type">Date</span>.parse(<span class="string"><span class="delimiter">'</span><span class="content">MM/dd/yyyy</span><span class="delimiter">'</span></span>, <span class="local-variable">it</span>) }
map <span class="string"><span class="delimiter">'</span><span class="content">birthDate</span><span class="delimiter">'</span></span> into <span class="string"><span class="delimiter">'</span><span class="content">birthday</span><span class="delimiter">'</span></span> using { LocalDate d -&gt; d.format(BASIC_ISO_DATE) }</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_runtime_mappers">Runtime Mappers</h3>
<div class="paragraph">
<p>The <code>RuntimeObjectMapper</code> is created using its static <code>mapper(Closure)</code> method, where the <code>Closure</code> contains the configuration DSL. An example would
be something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">ObjectMapper inividualToPerson = RuntimeObjectMapper.mapper {
    map <span class="string"><span class="delimiter">'</span><span class="content">id</span><span class="delimiter">'</span></span>
    map <span class="string"><span class="delimiter">'</span><span class="content">givenName</span><span class="delimiter">'</span></span> into <span class="string"><span class="delimiter">'</span><span class="content">firstName</span><span class="delimiter">'</span></span>
    map <span class="string"><span class="delimiter">'</span><span class="content">familyName</span><span class="delimiter">'</span></span> into <span class="string"><span class="delimiter">'</span><span class="content">lastName</span><span class="delimiter">'</span></span>
    map <span class="string"><span class="delimiter">'</span><span class="content">birthDate</span><span class="delimiter">'</span></span> using { d-&gt; LocaleDate.parse(d) }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compiled_mappers">Compiled Mappers</h3>
<div class="paragraph">
<p>Sometimes you need to squeeze a bit more performance out of a mapping operation, or you just want to generate cleaner code. The
<code>InjectCompiledObjectMapper</code> annotation is used to annotate a field or property to inject a compile-time generated <code>ObjectMapper</code> implementation
(using AST Transformations) based on the supplied DSL configuration.</p>
</div>
<div class="paragraph">
<p>Using the compiled approach is as simple as the runtime approach, you just write the DSL code in the <code>@InjectObjectMapper</code> annotation on a method,
or field:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">ObjectMappers</span> {

    <span class="annotation">@InjectObjectMapper</span>({
        map <span class="string"><span class="delimiter">'</span><span class="content">id</span><span class="delimiter">'</span></span>
        map <span class="string"><span class="delimiter">'</span><span class="content">givenName</span><span class="delimiter">'</span></span> into <span class="string"><span class="delimiter">'</span><span class="content">firstName</span><span class="delimiter">'</span></span>
        map <span class="string"><span class="delimiter">'</span><span class="content">familyName</span><span class="delimiter">'</span></span> into <span class="string"><span class="delimiter">'</span><span class="content">lastName</span><span class="delimiter">'</span></span>
        map <span class="string"><span class="delimiter">'</span><span class="content">birthDate</span><span class="delimiter">'</span></span> using { d-&gt; LocaleDate.parse(d) }
    })
    <span class="directive">static</span> <span class="directive">final</span> ObjectMapper personMapper(){}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the code compiles, a new implementation of ObjectMapper will be created and installed as the return value for the personMapper() method.
The compiled version of the DSL has all of the same functionality of the dynamic version except that it does not support using ObjectMappers
directly in the using command; however, a workaround for this is to use a closure to wrap another <code>ObjectMapper</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_usage">Usage</h3>
<div class="paragraph">
<p>Once you have created an <code>ObjectMapper</code> using either the runtime or compile-time implementations, objects can be copied using the
<code>copy(Object,Object)</code> method, which will copy the properties of the source object into the destination object according to the configured mapping
information in the DSL.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> people = individuals.collect { indiv-&gt;
    Person person = <span class="keyword">new</span> Person()
    individualToPerson.copy(indiv, person)
    person
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Person</code> objects will now contain the correctly mapped property values from the <code>Individual</code> objects. The <code>ObjectMapper</code> also has a
<code>create(Object, Class)</code> method to help simplify the use case where you are simply creating a new populated instance of the destination object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> people = individuals.collect { indiv-&gt;
    individualToPerson.create(indiv, Person)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When using the <code>create()</code> method, the destination object must have a default constructor.</p>
</div>
<div class="paragraph">
<p>The third, slightly more useful option in this specific collector case is to use the <code>collector(Class)</code> method, which again takes the type of the
destination object (with a default constructor):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> people = individuals.collect( individualToPerson.collector(Person) )</code></pre>
</div>
</div>
<div class="paragraph">
<p>The collector(Class) method returns a Closure that is also a shortcut to the conversion code shown previously. It&#8217;s mostly syntactic sugar, but it is
nice and clean to work with.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resultset_mappers">ResultSet Mappers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A common operation while working with a databases is the mapping of row data to objects in code. This has always seemed very repetitive and error
prone. The Vanilla library provides a simple DSL-based solution for quickly implementing code that extracts, and optionally transforms, the data
from the database table (via a <code>ResultSet</code>) and uses it to populate the object representation of your choice.</p>
</div>
<div class="paragraph">
<p>There are two implementations available, one that is dynamic and does all the extraction and conversion work at runtime, and a second which
pre-compiles the extraction code at compile time using AST transformations.</p>
</div>
<div class="sect2">
<h3 id="_mapping_style">Mapping Style</h3>
<div class="paragraph">
<p>There are two styles of mapping available to both implementations of the mapping framework:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>MappingStyle.IMPLICIT</code> - All properties of the mapped object are mapped by default, though the DSL may be used to alter property extraction or ignore properties.</p>
</li>
<li>
<p><code>MappingStyle.EXPLICIT</code> - No properties of the mapped object are mapped by default. All mapping must be explicitly configured by the DSL.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_dsl">DSL</h3>
<div class="paragraph">
<p>The DSL used by the <code>ResultSetMapper</code> framework is shared between both the runtime and Compiled Implementations. There are five supported mapping
statements:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>ignore &lt;property-name&gt;[,&lt;property-name&gt;&#8230;&#8203;]</code></dt>
<dd>
<p>Used to ignore one or more of the mapped objects properties. This operation is meaningless for explicit mappers.</p>
</dd>
<dt class="hdlist1"><code>map &lt;property-name&gt;</code></dt>
<dd>
<p>Maps the specified object property with the default extraction type (uses <code>from &lt;field-name&gt;</code>) and no conversion.</p>
</dd>
<dt class="hdlist1"><code>map &lt;property-name&gt; from[TYPE] &lt;field-name&gt;</code></dt>
<dd>
<p>Maps the specified object property with the specified extraction type and field name with no conversion.</p>
</dd>
<dt class="hdlist1"><code>map &lt;property-name&gt; from[TYPE] &lt;field-name&gt; using &lt;closure&gt;</code></dt>
<dd>
<p>Maps the specified object property with the specified extraction type with the provided conversion closure.</p>
</dd>
<dt class="hdlist1"><code>map &lt;property-name&gt; using &lt;closure&gt;</code></dt>
<dd>
<p>Maps the specified object property with the default extraction type (uses <code>from &lt;field-name&gt;</code>) with the provided conversion closure.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Auto-conversions of the property name to a database field name are done as camel-case to underscore-based notation similar to the following:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>something            --becomes--&gt; something
somethingInteresting --becomes--&gt; something_interesting
anotherPropertyName  --becomes--&gt; another_property_name</pre>
</div>
</div>
<div class="paragraph">
<p>The extraction types are defined analogous to the getter methods provided in the <code>ResultSet</code> but with the "from" prefix in place of "get". The
supported extractors are: <code>from</code>, <code>fromObject</code>, <code>fromString</code>, <code>fromBoolean</code>, <code>fromByte</code>, <code>fromShort</code>, <code>fromInt</code>, <code>fromLong</code>, <code>fromFloat</code>, <code>fromDouble</code>,
<code>fromBytes</code>, <code>fromDate</code>, <code>fromTime</code>, <code>fromTimestamp</code>, <code>fromAsciiStream</code>, <code>fromUnicodeStream</code>, <code>fromBinaryStream</code>, <code>fromCharacterStream</code>,
<code>fromBigDecimal</code>, <code>fromRef</code>, <code>fromBlob</code>, <code>fromClob</code>, <code>fromArray</code>, <code>fromURL</code>, <code>fromMapper</code>.</p>
</div>
<div class="paragraph">
<p>Each extractor takes either the database field name or position value as a required parameter and extracts the database value as you would expect from its name, though you may want to consult the <code>ResultSet</code> documentation for more details on the behavior of a specific getter method.</p>
</div>
<div class="paragraph">
<p>The exceptional extractor case is the <code>fromMapper</code> extractor. This extractor accepts a <code>ResultSetMapper</code> instance which will be used to extract the object for the specified target property. An example of such a mapping would be the following:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>map 'foo' fromMapper Foo.mapper('foo_')</pre>
</div>
</div>
<div class="paragraph">
<p>where <code>Foo.mapper(String)</code> is a mapper factory method.</p>
</div>
<div class="paragraph">
<p>The conversion closures configured by the <code>using</code> clause are standard Groovy closures that are passed in one or two arguments:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>1-argument: the extracted database value at runtime which allows the closure to do additional conversion of the database value.</p>
</li>
<li>
<p>2-argument: the reference to the <code>ResultSet</code> being extracted.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The closure should return the desired mapped value for the property.</p>
</div>
<div class="paragraph">
<p>A sample of the DSL pulled from the unit tests is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">ignore <span class="string"><span class="delimiter">'</span><span class="content">bankPin</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">pet</span><span class="delimiter">'</span></span>
ignore <span class="string"><span class="delimiter">'</span><span class="content">children</span><span class="delimiter">'</span></span>
map <span class="string"><span class="delimiter">'</span><span class="content">birthDate</span><span class="delimiter">'</span></span> fromDate <span class="string"><span class="delimiter">'</span><span class="content">birth_date</span><span class="delimiter">'</span></span>
map <span class="string"><span class="delimiter">'</span><span class="content">age</span><span class="delimiter">'</span></span> from <span class="integer">2</span> using { a -&gt; a - <span class="integer">5</span> }
map <span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span> from <span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_runtime_implementation">Runtime Implementation</h3>
<div class="paragraph">
<p>The runtime implementation uses the static <code>mapper(Class, MappingStyle, Closure)</code> method from <code>ResultSetMapperBuilder</code> as its entry point. The object
type being mapped is provided, as well as the mapping style and an optional configuration closure (<a href="#_dsl">DSL</a>). Using our example code from the DSL
section, you would have something like the following for an <code>IMPLICIT</code> mapping:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">ResultSetMapper mapper = ResultSetMapperBuilder.mapper(Person){
    ignore <span class="string"><span class="delimiter">'</span><span class="content">bankPin</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">pet</span><span class="delimiter">'</span></span>
    ignore <span class="string"><span class="delimiter">'</span><span class="content">children</span><span class="delimiter">'</span></span>
    map <span class="string"><span class="delimiter">'</span><span class="content">birthDate</span><span class="delimiter">'</span></span> fromDate <span class="string"><span class="delimiter">'</span><span class="content">birth_date</span><span class="delimiter">'</span></span>
    map <span class="string"><span class="delimiter">'</span><span class="content">age</span><span class="delimiter">'</span></span> from <span class="integer">2</span> using { a -&gt; a - <span class="integer">5</span> }
    map <span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span> from <span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An <code>IMPLICIT</code> mapping has a very clean format for cases where your mapped object aligns with the database fields and types. You can simply map it with
no configuration DSL.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">ResultSetMapper mapper = ResultSetMapperBuilder.mapper(Person)</code></pre>
</div>
</div>
<div class="paragraph">
<p>An <code>EXPLICIT</code> mapping for the same configuration could be something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">ResultSetMapper mapper = ResultSetMapperBuilder.mapper(Person, MappingStyle.EXPLICIT){
    map <span class="string"><span class="delimiter">'</span><span class="content">birthDate</span><span class="delimiter">'</span></span> fromDate <span class="string"><span class="delimiter">'</span><span class="content">birth_date</span><span class="delimiter">'</span></span>
    map <span class="string"><span class="delimiter">'</span><span class="content">age</span><span class="delimiter">'</span></span> from <span class="integer">2</span> using { a -&gt; a - <span class="integer">5</span> }
    map <span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span> using { n-&gt; <span class="string"><span class="delimiter">&quot;</span><span class="content">Name: </span><span class="inline"><span class="inline-delimiter">$</span>n</span><span class="delimiter">&quot;</span></span>}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The mapping, extraction and conversion operations are all performed at runtime. Some pre-computing or caching may be performed; however, the bulk of
the mapping is done at runtime with each mapped object creation.</p>
</div>
<div class="paragraph">
<p>The created mappers are reusable and thread-safe.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
While the dynamic runtime implementation is fully supported and maintained, it is generally advisable to use the <a href="#_compiled_implementation">Compiled Implementation</a> to generation more performant code.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_compiled_implementation">Compiled Implementation</h3>
<div class="paragraph">
<p>The Compiled Implementation uses the <code>InjectResultSetMapper</code> annotation to inject a configured <code>ResultSetMapper</code> into a field or method of a class.</p>
</div>
<div class="paragraph">
<p>Using the example from the <a href="#_runtime_implementation">Runtime Implementation</a> section, we could have an <code>IMPLICIT</code> mapper available as a static method as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Mappers</span> {

    <span class="annotation">@InjectResultSetMapper</span>(
        value=Person,
        config={
            ignore <span class="string"><span class="delimiter">'</span><span class="content">bankPin</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">pet</span><span class="delimiter">'</span></span>
            ignore <span class="string"><span class="delimiter">'</span><span class="content">children</span><span class="delimiter">'</span></span>
            map <span class="string"><span class="delimiter">'</span><span class="content">birthDate</span><span class="delimiter">'</span></span> fromDate <span class="string"><span class="delimiter">'</span><span class="content">birth_date</span><span class="delimiter">'</span></span>
            map <span class="string"><span class="delimiter">'</span><span class="content">age</span><span class="delimiter">'</span></span> from <span class="integer">2</span> using { a -&gt; a - <span class="integer">5</span> }
            map <span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span> from <span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span>
        }
    )
    <span class="directive">static</span> ResultSetMapper personMapper(){}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>personMapper()</code> method returns the same <code>ResultSetMapper</code> instance for every call and the mapper itself is configured at compile-time via AST
transformations so that the extraction calls are generated at compile-time rather than for each mapping call; however, the conversion closures are
still executed at runtime.</p>
</div>
<div class="paragraph">
<p>For <code>IMPLICIT</code> mappings where the object property names and type align with the database fields, you can have a very simple <code>IMPLICIT</code> mapping
configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Mappers</span> {

    <span class="annotation">@InjectResultSetMapper</span>(Person)
    <span class="directive">static</span> ResultSetMapper personMapper(){}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Creation of <code>EXPLICIT</code> mappers follows a similar style:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Mappers</span> {

    <span class="annotation">@InjectResultSetMapper</span>(
        value=Person,
        style=MappingStyle.EXPLICIT,
        config={
            map <span class="string"><span class="delimiter">'</span><span class="content">birthDate</span><span class="delimiter">'</span></span> fromDate <span class="string"><span class="delimiter">'</span><span class="content">birth_date</span><span class="delimiter">'</span></span>
            map <span class="string"><span class="delimiter">'</span><span class="content">age</span><span class="delimiter">'</span></span> from <span class="integer">2</span> using { a -&gt; a - <span class="integer">5</span> }
            map <span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span> using { n-&gt; <span class="string"><span class="delimiter">&quot;</span><span class="content">Name: </span><span class="inline"><span class="inline-delimiter">$</span>n</span><span class="delimiter">&quot;</span></span>}
        }
    )
    <span class="directive">static</span> ResultSetMapper personMapper(){}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The method or field used to provide the compiled mapper does not need to be static; however, it is advisable, since the underlying instance created
will be a static field of the enclosing class.</p>
</div>
<div class="paragraph">
<p>The generated mapper class is created in the same package as the mapped object type. The <code>InjectResultSetMapper</code> annotation also provides a <code>name</code>
property which may be used to provide an alternate name for the generated mapper class. By default, the name of the mapped object type is used with
the added "Mapper" suffix.</p>
</div>
<div class="paragraph">
<p>The generated mapper class may be used directly; however, the method or field injection is required to create the mapper class and it is recommended
to use the field or method as your access point to the generated class.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
When using a factory method to create the <code>ResultSetMapper</code> instances, note that the method is annotated with <code>@Memoized</code> so that multiple calls to the method will return the same instance. This is also true when a prefix is used (method parameter); calls to the method with the same prefix value will return the same instance of the mapper.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_usage_2">Usage</h3>
<div class="paragraph">
<p>Once you have created a <code>ResultSetMapper</code>, you can use it anywhere you have a <code>ResultSet</code> or with the <code>groovy.sql.Sql</code> class as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> sql = Sql.newInstance(db.url, db.user, db.password, db.driver)

<span class="keyword">def</span> people = <span class="type">[]</span>

sql.eachRow(<span class="string"><span class="delimiter">'</span><span class="content">select * from people</span><span class="delimiter">'</span></span>){ rs-&gt;
    people &lt;&lt; Mappers.personMapper().call(rs)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where we are using the compiled mapper implementation exposed by the <code>Mappers.personMapper()</code> method. The <code>call(ResultSet)</code> method performs the mapping
of the current <code>ResultSet</code> data into a <code>Person</code> object.</p>
</div>
<div class="paragraph">
<p>An alias to the <code>call(ResultSet)</code> method is provided as the <code>mapRow(ResultSet, int)</code> method, which allows for simple interaction with the
<a href="http://projects.spring.io/spring-framework/">Spring Framework</a> as a <code>RowMapper</code>, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">List</span>&lt;Person&gt; people = jdbcTemplate.query(
    <span class="string"><span class="delimiter">'</span><span class="content">select * from people</span><span class="delimiter">'</span></span>,
    Mappers.personMapper() <span class="keyword">as</span> <span class="predefined-type">RowMapper</span>
)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>ResultSetMapper</code> may be cast as a <code>RowMapper</code> and then used as one.</p>
</div>
</div>
<div class="sect2">
<h3 id="_field_name_prefix">Field Name Prefix</h3>
<div class="paragraph">
<p>Both implementations of the <code>ResultSetMapper</code> support an optional field name prefix, which will be applied to all field names on field lookup. So for example a property named "somethingInteresting" with a prefix of "foo_" would look for a database field named "foo_something_interesting". If no prefix is specified an empty string will be used.</p>
</div>
<div class="paragraph">
<p>The prefix is <em>not</em> overridden by the "fromXXX" mapping methods. This is intentional since the main goal of the prefix support is to allow the same mapper to be useful across different mapping scenarios such as in a join where each column name in the query result has been prefixed by some common known prefix.</p>
</div>
<div class="paragraph">
<p>This does not remove the ability to use numerical from indices. If a number is detected in the "from" statement, the prefix will not be applied.</p>
</div>
</div>
<div class="sect2">
<h3 id="_mapping_properties_from_multiple_fields">Mapping Properties from Multiple Fields</h3>
<div class="paragraph">
<p>It is often necessary to map an object field that is not directly represented in the database fields or is made up of more than on field. This is can be done by using the 2-argument version of the "using" closure. Consider the example of a <code>GeoLocation</code> object being mapped:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="annotation">@Canonical</span>
<span class="type">class</span> <span class="class">GeoLocation</span> {
    <span class="type">double</span> latitude
    <span class="type">double</span> longitude
}

<span class="type">class</span> <span class="class">Somewhere</span> {
    GeoLocation location
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The DSL code would look something like the following:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{
    map 'location' fromDouble 'latitude' using { lat,rs-&gt;
        new GeoLocation(lat, rs.getDouble('longitude'))
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p>This allows the flexibility to populate the target object from various database fields.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_mockresultset_dsl">MockResultSet DSL</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Mocking interactions with a database can be frustrating; however, the <a href="http://mockrunner.github.io/">MockRunner JDBC</a> library can really simplify the
mocking of <code>ResultSet</code> interaction, which is often enough to get basic unit testing done. Vanilla provides an added layer on top of the MockRunner
<code>MockResultSet</code> class so that the <code>ResultSet</code> may be configured using a simple DSL, such as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">ResultSet</span> rs = ResultSetBuilder.resultSet {
    columns <span class="string"><span class="delimiter">'</span><span class="content">first_name</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">last_name</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">phone_number</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">age</span><span class="delimiter">'</span></span>
    data <span class="string"><span class="delimiter">'</span><span class="content">Fred</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Flintstone</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">555-123-9876</span><span class="delimiter">'</span></span>, <span class="integer">56</span>
    object phoneRecord
    map <span class="key">firstName</span>:<span class="string"><span class="delimiter">'</span><span class="content">Barney</span><span class="delimiter">'</span></span>, <span class="key">lastName</span>:<span class="string"><span class="delimiter">'</span><span class="content">Rubble</span><span class="delimiter">'</span></span>, <span class="key">age</span>:<span class="integer">55</span>, <span class="key">phoneNumber</span>:<span class="string"><span class="delimiter">'</span><span class="content">555-222-3456</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The resulting <code>ResultSet</code> is implemented by the <code>com.mockrunner.mock.jdbc.MockResultSet</code> class from MockRunner and should behave like a real <code>ResultSet</code>
within the scope of the test mocking.</p>
</div>
<div class="sect2">
<h3 id="_resultset_dsl">ResultSet DSL</h3>
<div class="paragraph">
<p>The <code>ResultSet</code> DSL consists of four statements:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>columns</code></dt>
<dd>
<p>Accepts a <code>String&#8230;&#8203;</code> or <code>List&lt;String&gt;</code> argument to provide the names of the columns configured in the <code>ResultSet</code>.</p>
</dd>
<dt class="hdlist1"><code>data</code></dt>
<dd>
<p>Accepts a <code>String&#8230;&#8203;</code> or <code>List&lt;String&gt;</code> argument to provide the data for a single row, in the same order as the columns.</p>
</dd>
<dt class="hdlist1"><code>object</code></dt>
<dd>
<p>Accepts an Object which will be used to populate the row. The column names will be converted to camel-case and used to find properties on the object.</p>
</dd>
<dt class="hdlist1"><code>map</code></dt>
<dd>
<p>Accepts a Map which will be used to populate the row. The column names will be converted to camel-case and used to find properties in the map.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overlappable">Overlappable</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Determining whether or not two objects overlap is pretty straight-forward when there is only a single variable of comparison; however, what about the
case where you have multiple variables to consider, for example if we have a group of people "People A" who are males between 15 and 25, weighing
between 200 and 300 pounds:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>People A
Ages: 15-25
Gender: M
Weight: 200-300</pre>
</div>
</div>
<div class="paragraph">
<p>Now consider the case when you have other search rules in the same search and that for the sake of efficiency we want to find overlapping rules and
merge them into one (we will only consider the overlap determination here). With two other rules:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>People B
Ages: 13-20
Gender: M
Weight: 250-400

People C
Ages: 8-10
Gender: M
Weight: 200-300</pre>
</div>
</div>
<div class="paragraph">
<p>It&#8217;s not hard to look at the rules and determine which ones overlap. "People A" overlaps with "People B", while "People C" does not overlap with
either of the other two. In code this can be a difficult comparison to do correctly and efficiently. Also, as your number of comparison axes
increases, so does the complexity of determining overlap for any given pair of objects.</p>
</div>
<div class="paragraph">
<p>What is needed is a simple means of determining the overlap of two objects and the best way I have found to do that is to break each object down into
its overlap-comparison components, each of which I will call a "Lobe" from here on out. I chose the term lobe because it is defined as: "any rounded
projection forming part of a larger structure". Also, terms like element and node are used far too much already in programming.</p>
</div>
<div class="paragraph">
<p>When you break each object down into it&#8217;s lobes, you will have one lobe for Gender, one for Ages, and one for weights. Now you can build your overlap
determination based on whether or not each lobe overlaps with its corresponding lobe on the other object. If all of the lobes overlap those of the
other object, then the two objects are considered overlapping, otherwise they are not. This allows for a fail-fast comparison since if the comparison
of any given lobe fails, you cannot have an overlapping object and no further comparison is necessary.</p>
</div>
<div class="paragraph">
<p>In code a lobe can be defined by interface as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">interface</span> Lobe {
    <span class="type">boolean</span> overlaps( Lobe other )
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each <code>Lobe</code> implementation defines what it means to overlap another <code>Lobe</code> of the same type. Using Groovy and some generic logic we can easily come
up with a <code>ComparableLobe</code> which is based on single values and ranges of <code>Comparable</code> objects such as numbers, strings and ranges. This allows us to
do things like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">new</span> ComparableLobe( <span class="integer">10</span>..<span class="integer">20</span>, <span class="integer">50</span>, <span class="integer">75</span> )
<span class="keyword">new</span> ComparableLobe( <span class="string"><span class="delimiter">'</span><span class="content">a</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">h</span><span class="delimiter">'</span></span>..<span class="string"><span class="delimiter">'</span><span class="content">j</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">m</span><span class="delimiter">'</span></span> )

lobeA.overlaps( lobeB )</code></pre>
</div>
</div>
<div class="paragraph">
<p>which can make the overlap determination very flexible.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> genderLobe = <span class="keyword">new</span> ComparableLobe( <span class="string"><span class="delimiter">'</span><span class="content">M</span><span class="delimiter">'</span></span> )
<span class="keyword">def</span> agesLobe = <span class="keyword">new</span> ComparableLobe( <span class="integer">15</span>..<span class="integer">25</span> )
<span class="keyword">def</span> weightsLobe = <span class="keyword">new</span> ComparableLobe( <span class="integer">200</span>..<span class="integer">300</span> )</code></pre>
</div>
</div>
<div class="paragraph">
<p>The next thing we need is a way of comparing these lobes in a simple and repeatable manner and that&#8217;s where the <code>Overlappable</code> trait comes in. The
<code>Overlappable</code> trait defines an object that can be compared for overlap. The required method is basically the same as that of the Lobe; however, this
trait is for the parent object itself. By providing an abstract implementation of this interface we have a nice clean way of providing overlap
detection functionality for an object type. You could create a simple <code>Overlappable</code> Person object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">People</span> <span class="directive">implements</span> Overlappable {
    <span class="predefined-type">String</span> gender
    IntRange ages
    IntRange weights

    <span class="annotation">@Override</span> Lobe<span class="type">[]</span> getLobes() {
        [
            <span class="keyword">new</span> ComparableLobe(gender),
            <span class="keyword">new</span> ComparableLobe(ages),
            <span class="keyword">new</span> ComparableLobe(weights)
        ]
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The overlaps() method uses the provided Lobes to populate an <code>OverlapBuilder</code>, which is basically a helper class for performing the actual
Lobe-to-Lobe comparison of a given set of Lobes. The <code>OverlapBuilder</code> is inspired by the builder in the Apache Commons - Lang API, such as
<code>EqualsBuilder</code> and <code>HashCodeBuilder</code>. You create an instance and append your Lobes to it, then execute the <code>overlap()</code> method to perform the
comparison.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">new</span> OverlapBuilder()
    .appendLobe(<span class="keyword">new</span> ComparableLobe(<span class="integer">1</span>..<span class="integer">10</span>), <span class="keyword">new</span> ComparableLobe(<span class="integer">5</span>..<span class="integer">15</span>))
    .overlap()</code></pre>
</div>
</div>
<div class="paragraph">
<p>It also provides an append method for simple comparable cases:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">overlapBuilder.appendComparable( <span class="integer">20</span>..<span class="integer">25</span>, <span class="integer">15</span>..<span class="integer">30</span> )</code></pre>
</div>
</div>
<div class="paragraph">
<p>which just wraps each value in a <code>ComparableLobe</code>. Now, given a list of People objects, you can determine if any of them overlap any of the others
simply by iterating over the list and comparing each element with the others:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> list = [
    <span class="keyword">new</span> Person( <span class="key">gender</span>:<span class="string"><span class="delimiter">'</span><span class="content">M</span><span class="delimiter">'</span></span>, <span class="key">ages</span>:<span class="integer">15</span>..<span class="integer">25</span>, <span class="key">weights</span>:<span class="integer">200</span>..<span class="integer">300</span> ),
    <span class="keyword">new</span> Person( <span class="key">gender</span>:<span class="string"><span class="delimiter">'</span><span class="content">M</span><span class="delimiter">'</span></span>, <span class="key">ages</span>:<span class="integer">13</span>..<span class="integer">20</span>, <span class="key">weights</span>:<span class="integer">250</span>..<span class="integer">400</span> ),
    <span class="keyword">new</span> Person( <span class="key">gender</span>:<span class="string"><span class="delimiter">'</span><span class="content">M</span><span class="delimiter">'</span></span>, <span class="key">ages</span>:<span class="integer">8</span>..<span class="integer">10</span>, <span class="key">weights</span>:<span class="integer">200</span>..<span class="integer">300</span> )
]

list[<span class="integer">0</span>..-<span class="integer">2</span>].eachWithIndex { self, idx-&gt;
    list[(idx+<span class="integer">1</span>)..(-<span class="integer">1</span>)].each { other-&gt;
        <span class="keyword">if</span>( self.overlaps( other ) ){
            println <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>self</span><span class="content"> overlaps </span><span class="inline"><span class="inline-delimiter">$</span>other</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As a final little bonus feature, there is a <code>ComparableLobe.ANY</code> object which denotes a <code>Lobe</code> that will always be considered to overlap, no matter
what the other value is.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_test_fixtures">Test Fixtures</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Unit testing with data fixtures is good habit to get into, and having a simple means of creating and managing reusable fixture data makes it much
more likely. The <code>FixtureBuilder</code> and <code>Fixture</code> class can simplify the creation of reusable test fixtures using a small DSL.</p>
</div>
<div class="paragraph">
<p>The text fixtures created using the <code>FixtureBuilder</code> are the properties required to build new instances of objects needed for testing.</p>
</div>
<div class="paragraph">
<p>The reasoning behind using Maps is that Groovy allows them to be used as constructor arguments for creating objects; therefore, the maps give you a
reusable and detached data set for use in creating your test fixture instances. Two objects instances created from the same fixture data will be
equivalent at the level of the properties defined by the fixture; however, each can be manipulated without effecting the other.</p>
</div>
<div class="paragraph">
<p>One thing to note about the fixtures is that the fixture container and the maps that are passed in as individual fixture data are all made immutable
via the asImmutable() method; however, if the data inside the fixture is mutable, it still may have the potential for being changed. Be aware of this
and take proper precautions when you create an interact with such data types.</p>
</div>
<div class="sect2">
<h3 id="_fixture_dsl">Fixture DSL</h3>
<div class="paragraph">
<p>The <code>FixtureBuilder</code> has three operations available to its DSL:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>define</code></dt>
<dd>
<p>The DSL entry point method, which accpets the DSL closure and creates the <code>Fixture</code> container.</p>
</dd>
<dt class="hdlist1"><code>fix(Object,Map)</code></dt>
<dd>
<p>Uses the specified Map data as the content for the fixture with the provided key.</p>
</dd>
<dt class="hdlist1"><code>fix(Object,PropertyRandomizer)</code></dt>
<dd>
<p>Uses the specified <code>PropertyRandomizer</code> to generate random content for the fixture with the provided key.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The <code>build()</code> method is then used to create the populated <code>Fixture</code> container object.</p>
</div>
</div>
<div class="sect2">
<h3 id="_usage_3">Usage</h3>
<div class="paragraph">
<p>A fixture for a <code>Person</code> class, such as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Person</span> {
    <span class="predefined-type">Name</span> name
    LocalDate birthDate
    <span class="type">int</span> score
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>could have fixtures created using the following code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">PersonFixtures</span> {

    <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> BOB = <span class="string"><span class="delimiter">'</span><span class="content">Bob</span><span class="delimiter">'</span></span>
    <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> LARRY = <span class="string"><span class="delimiter">'</span><span class="content">Larry</span><span class="delimiter">'</span></span>

    <span class="directive">static</span> <span class="directive">final</span> Fixture FIXTURES = define {
        fix BOB, [ <span class="key">name</span>:<span class="keyword">new</span> <span class="predefined-type">Name</span>(<span class="string"><span class="delimiter">'</span><span class="content">Bob</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">Q</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">Public</span><span class="delimiter">'</span></span>), <span class="key">birthDate</span>:LocalDate.of(<span class="integer">1952</span>,<span class="integer">5</span>,<span class="integer">14</span>), <span class="key">score</span>:<span class="integer">120</span> ]
        fix LARRY, [ <span class="key">name</span>:<span class="keyword">new</span> <span class="predefined-type">Name</span>(<span class="string"><span class="delimiter">'</span><span class="content">Larry</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">G</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">Larson</span><span class="delimiter">'</span></span>), <span class="key">birthDate</span>:LocalDate.of(<span class="integer">1970</span>,<span class="integer">2</span>,<span class="integer">8</span>), <span class="key">score</span>:<span class="integer">100</span> ]
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>I tend to create a main class to contain my fixtures and to also provide the set of supported fixture keys. Notice that the <code>define</code> method is where
you create the data contained by the fixtures, each mapped with an object key. The key can be any object which may be used as a <code>Map</code> key (proper
equals and hashCode implementation).</p>
</div>
<div class="paragraph">
<p>Once your fixtures are defined, you can use them in various ways. You can request the immutable data map for a fixture:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">Map</span> data = PersonFixtures.FIXTURES.map(PersonFixtures.BOB)</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can create an instance of the target object using the data mapped to a specified fixture:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">Person person = PersonFixtures.FIXTURES.object(Person, PersonFixtures.LARRY)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or, you can request the data or an instance for a fixture while applying additional (or overridden) properties to the fixture data:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">Map</span> data = PersonFixtures.FIXTURES.map(PersonFixtures.BOB, <span class="key">score</span>:<span class="integer">53</span>)
Person person = PersonFixtures.FIXTURES.object(Person, PersonFixtures.LARRY, <span class="key">score</span>:<span class="integer">200</span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can easily retrieve field property values for each fixture for use in your tests:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">assert</span> <span class="integer">100</span> == PersonFixtures.FIXTURES.field(<span class="string"><span class="delimiter">'</span><span class="content">score</span><span class="delimiter">'</span></span>, PersonFixtures.LARRY)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This allows field-by-field comparisons for testing and the ability to use the field values as parameters as needed.</p>
</div>
<div class="paragraph">
<p>Lastly, you can verify that an object instance contains the expected data that is associated with a fixture:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">assert</span> PersonFixtures.FIXTURES.verify(person, PersonFixtures.LARRY)</code></pre>
</div>
</div>
<div class="paragraph">
<p>which will compare the given object to the specified fixture and return true of all of the properties defined in the fixture match the same
properties of the given object. There is also a second version of the method which allows property customizations before comparison.</p>
</div>
<div class="paragraph">
<p>One step farther&#8230;&#8203; you can combine fixtures with property randomization to make fixture creation even simpler for those cases where you don&#8217;t care
about what the properties are, just that you can get at them reliably.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="directive">static</span> <span class="directive">final</span> Fixture FIXTURES = define {
    fix FIX_A, [ <span class="key">name</span>:randomize(<span class="predefined-type">Name</span>).one(), <span class="key">birthDate</span>:LocalDate.of(<span class="integer">1952</span>,<span class="integer">5</span>,<span class="integer">14</span>), <span class="key">score</span>:<span class="integer">120</span> ]
    fix FIX_B, randomize(Person){
        typeRandomizers(
            (<span class="predefined-type">Name</span>): randomize(<span class="predefined-type">Name</span>),
            (LocalDate): { LocalDate.now() }
        )
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The fixture mapper accepts <code>PropertyRandomizer</code> instances and will use them to generate the random content once, when the fixture is created and
then it will be available unchanged during the testing.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_rolling_file">Rolling File</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We often run into rolling log files that cutoff and rollover to a new file according to some configured rules; however, this is
also a useful feature outside of logging. A <code>RollingFile</code> is based on a standard <code>File</code> but will "roll" the file based on a
<code>RolloverTriggerStrategy</code> implementation - the default is based on file size. Once the conditions of the strategy are met, the file
will rollover using a <code>RolloverFileProvider</code> implementation to determine the name and path of the rolled file (the default is to
create a file in the same directory with a name suffixed with the timestamp at the time the file was cut. Being that both of these
strategies are interfaces, the functionality is pluggable and extensible.</p>
</div>
<div class="paragraph">
<p>Optionally, the rolled files may be compressed.</p>
</div>
<div class="paragraph">
<p>An example of using a <code>RolledFile</code> is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">RollingFile rollingFile = <span class="keyword">new</span> RollingFile(
    <span class="key">file</span>: <span class="keyword">new</span> <span class="predefined-type">File</span>(<span class="string"><span class="delimiter">'</span><span class="content">/some/file.json</span><span class="delimiter">'</span></span>),
    <span class="key">rolloverStrategy</span>: <span class="keyword">new</span> FileSizeRolloverTriggerStrategy(<span class="integer">1</span>, StorageUnit.MEGABYTES),
    <span class="key">compression</span>: <span class="predefined-constant">true</span>
)
rollingFile.append <span class="string"><span class="delimiter">'</span><span class="content">{ &quot;id:&quot;12345&quot;, &quot;label&quot;:&quot;item-01&quot;, &quot;value:&quot;:8675309 }</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>which will use <code>/some/file.json</code> as the initial target file, which will be rolled when a file write would cause the file size to
exceed 1 MB.</p>
</div>
<div class="paragraph">
<p>If for some reason you want the ability to optionally make a file rolling or not, you can use the <code>NoopRolloverTriggerStrategy</code> as
the <code>rolloverStrategy</code> so that the file will never roll. The strategy may be changed at runtime to cause the file to begin rolling
behavior.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_layered_configuration">Layered Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>com.stehno.vanilla.config</code> package contains a set of classes useful for providing a layered configuration framework similar to that provided by Ratpack or Spring, but without the other
framework overhead.</p>
</div>
<div class="paragraph">
<p>You could create a cached layered configuration mechanism with something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">ConfigurationSource config = <span class="keyword">new</span> CachedConfigurationSource(<span class="keyword">new</span> CompositeConfigurationSource([
    <span class="keyword">new</span> ZookeeperConfigurationSource(zkconfig),
    <span class="keyword">new</span> PropertiesConfigurationSource(props)
]))

<span class="predefined-type">String</span> serverHost = config.getString(<span class="string"><span class="delimiter">'</span><span class="content">server.host</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">localhost:1234</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>where the <code>ZookeeperConfigurationSource</code> would be your own implementation of the <code>ConfigurationSource</code> implementation used to extract configuration from Zookeeper.</p>
</div>
<div class="paragraph">
<p>When a configuration property is requested, such as in the example above, the <code>ZookeeperConfigurationSource</code> will be checked for the desired property key (<code>server.host</code>), if it does not contain
the key, the <code>PropertiesConfigurationSource</code> will be checked - if it is found, the value will be returned, if not, the default value of <code>localhost:1234</code> will be returned. The <code>CachedConfigurationSource</code>
decorator is used to provide a top-level caching layer so that once a property is resolved, it will not need to be resolved again.</p>
</div>
<div class="paragraph">
<p>The <code>ConfigurationSource</code> interface provides a rich set of property getter methods to retrieve properties as types other than just `String`s.</p>
</div>
<div class="paragraph">
<p>Multiple levels of nested configurations could be configured in this manner.</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 0.6.0<br>
Last updated 2017-12-08 07:12:44 CST
</div>
</div>
</body>
</html>